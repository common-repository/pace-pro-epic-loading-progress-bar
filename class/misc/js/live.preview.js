
jQuery(document).ready(function($){$('#colorpickerField').ColorPicker({onSubmit:function(hsb,hex,rgb,el){$(el).val(hex);$(el).ColorPickerHide();downloadTheme($("#pace_pro_global_style option:selected").data("theme"));},onBeforeShow:function(){$(this).ColorPickerSetColor(this.value);},}).bind('keyup',function(){$(this).ColorPickerSetColor(this.value);});var downloadTheme=function(theme){$.ajaxSetup({cache:false});jQuery.get(theme,function(css){css=new String(css);color=($("#colorpickerField").val()==""?"3d3d3d":$("#colorpickerField").val());css=css.replace(/%backgroundColor%/g,convertColor(color));$(".browser iframe").contents().find('style.second').text(css);});};downloadTheme($("#pace_pro_global_style option:selected").data("theme"));$("#pace_pro_global_style").change(function(){downloadTheme($("#pace_pro_global_style option:selected").data("theme"));$(".browser iframe").contents().find('s').append("<style>.pace .pace-progress{background: #CCC !important;}</style>");});jQuery('.browser iframe').each(function(){var _this=this;doc=(this.contentWindow||this.documentWindow).document;doc.open();doc.write(''+'<div class="pace pace pace-active">'+'<div class="pace-progress" data-progress="50" data-progress-text="50%" style="width: 50%;">'+'<div class="pace-progress-inner"></div>'+'</div>'+'<div class="pace-activity"></div>'+'</div>'+'<style class="second"></style>');doc.close();});var convertColor=function(color){var s="#"+color;var patt=/^#([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})$/;var matches=patt.exec(s);var rgb=parseInt(matches[1],16)+","+parseInt(matches[2],16)+","+parseInt(matches[3],16);return rgb;}});